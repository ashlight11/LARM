<launch>

    <!-- Launch File to use for Simulation Demo with a Gazebo :
    Autonomous Nav with obstacle avoidance and orientation according to room available -->

    <arg name="simulation" default="true" />
    <arg name="laser_topic" default="/scan"/>
    <arg name="rviz" default="true"/>

    <param name="use_sim_time" value="true" />

    <!-- Simulation parameter influences the Autonomous Navigation script -->
    <param name="simulation" value="$(arg simulation)" type="bool" /> 

    <param name="rviz" value="$(arg rviz)" unless="$(arg rviz)" /> 

    <!-- Gazebo : simulation tool -->
    <include file="$(find tbot_gazebo)/launch/start_world.launch">
        <arg name="world_file" value="$(find larm)/models/challenge-1.world" />
    </include>

    <!-- Gazebo -->
    <include file="$(find tbot_gazebo)/launch/spawn_tbot.launch">
        <arg name="x" value="-3.32" />
        <arg name="y" value="-2.95" />
        <arg name="yaw" value="2.86" />
    </include>
    
    <!-- Map the environment -->
    <node pkg="gmapping" type="slam_gmapping" name="slam_gmapping" args="scan:=$(arg laser_topic)" output="screen" />

    <!-- Autonomous Navigation script -->
    <node pkg="grp-poire" type="mover_and_laser_v2.py" name="autonomous_nav"/>

    <!-- Launch RVIZ only if the parameter is set to true-->
    <group if="$(arg rviz)">
        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find grp-poire)/rviz/config_challenge3_sim.rviz" />
    </group>

    
</launch>
